
# Story 4.1: Social Follow Integration with Feed

## Status
Draft

## Story
**As a** Pod.Style user,
**I want** to follow creators and see their new creations prioritized in my feed,
**so that** I can keep up with artists I like.

## Acceptance Criteria
1. Implement follow/unfollow server actions updating `social_edges` collection, maintaining counts on user profiles (`followers`, `following`), and logging events for analytics.  
2. Adjust feed service to boost entries from followed creators via personalization signals, ensuring Story 1.x ranking logic incorporates follow relationships.  
3. UI surfaces follow buttons on feed cards and creator profiles, updating state optimistically while syncing with server results.  
4. Observability logs follow/unfollow events, feed ranking adjustments due to follows, and exposes metrics for social engagement.  
5. Tests cover server action logic, feed recalculations, UI follow/unfollow flow, and regression ensuring legacy behavior when social features disabled.

## Tasks / Subtasks
- [ ] Follow/unfollow actions (AC: 1)  
  - [ ] Create server actions to add/remove entries in `social_edges`.  
  - [ ] Update profile counts and log analytics events.  
- [ ] Feed ranking boost (AC: 2)  
  - [ ] Modify feed service to apply personalization boost when creator is followed.  
  - [ ] Ensure fallback when follow data missing.  
- [ ] UI integration (AC: 3)  
  - [ ] Add follow buttons on feed cards/profile page; handle optimistic updates.  
  - [ ] Manage state changes, handle errors gracefully.  
- [ ] Observability (AC: 4)  
  - [ ] Emit metrics (`social.follow.success`, `feed.followBoost`).  
  - [ ] Document dashboards for social engagement.  
- [ ] Testing (AC: 5)  
  - [ ] Jest tests for follow actions and feed boost logic.  
  - [ ] Playwright tests for UI follow flow.  
  - [ ] Manual regression ensuring social flag can disable features.

## Dev Notes
### Data Models
- `social_edges` stores follow relationships; ensure compatibility with existing schema.  
  `[Source: architecture-brownfield.md#5.3-Data-Model]`

### Services
- Feed ranking adjustments must align with previous stories (ranking signals).  
  `[Source: architecture.md#4-Application-Architecture]`

### Component Specs
- UI should be consistent with design tokens; follow button states (Follow/Following).  
  `[Source: architecture.md#3-Business-User-Experience-Architecture]`

### File Locations
- Social actions in `src/features/social/server/actions.ts`; feed updates in `feed-service`.  
  `[Source: architecture.md#4-Application-Architecture]`

### Testing Requirements
- Unit + integration tests for social interactions, feed boost.  
  `[Source: architecture.md#8-Testing-Strategy]`

### Technical Constraints
- Feature flag for social features; ensure privacy (no overexposing follower lists).  
  `[Source: architecture.md#Next-Steps]`

## Testing
- Jest tests for follow logic and feed boost. `[Source: architecture.md#8-Testing-Strategy]`
- Playwright tests for UI flow. `[Source: architecture.md#8-Testing-Strategy]`

## Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2025-01-12 | v0.1 | Draft for social follow integration | Bob (scrum-master) |
