
# Story 5.2: User Reports & Appeals Workflow

## Status
Draft

## Story
**As a** Pod.Style user concerned about content,
**I want** to report creations and allow creators to appeal moderation decisions,
**so that** the platform stays safe while giving fair review opportunities.

## Acceptance Criteria
1. Implement user-facing report flow (on feed/creation detail) with reasons (IP violation, harassment, spam, etc.), storing reports in `moderation_flags` (linked to creation + reporter) and notifying moderators.  
2. Provide moderators with report queue filtering by reason/severity; allow merging duplicate reports and adding resolution notes.  
3. Introduce creator appeal flow (dashboard entry or email link) letting creators request review; appeals create tasks in moderation queue and track outcome.  
4. Observability logs report volume, resolution time, appeal success rate, and alerts when backlog grows or SLA breached.  
5. Tests cover reporting, moderator workflows, appeal handling, and regression ensuring feature flag controls availability.

## Tasks / Subtasks
- [ ] User report UI (AC: 1)  
  - [ ] Add report button/modal on creation/Feed viewer.  
  - [ ] Validate input and store in `moderation_flags` with status `pending_review`.  
- [ ] Moderator tools (AC: 2)  
  - [ ] Extend admin moderation queue to show reports grouped by reason; support merge/resolution notes.  
  - [ ] Notify moderators via existing channels.  
- [ ] Appeals (AC: 3)  
  - [ ] Create creator-facing appeal entry (profile or email link).  
  - [ ] Track appeals, update moderation status when resolved.  
- [ ] Observability (AC: 4)  
  - [ ] Emit metrics (`moderation.report.count`, `moderation.appeal.success`).  
  - [ ] Document alerts for backlog/SLA.  
- [ ] Testing (AC: 5)  
  - [ ] Jest tests for report/appeal actions.  
  - [ ] Playwright tests for UI flows (report & appeal).  
  - [ ] Manual regression ensuring flags control availability.

## Dev Notes
### Data Models
- `moderation_flags` stores reports, statuses, notes; appeals add additional fields.  
  `[Source: architecture-brownfield.md#5.3-Data-Model]`

### Services
- Moderation workflows integrate with feed removal; ensure appeals can reinstate content.  
  `[Source: architecture-brownfield.md#6-Workflows]`

### UI
- Report modal must clarify reasons and next steps; appeals UI should list status/history.  
  `[Source: architecture.md#3-Business-User-Experience-Architecture]`

### File Structure
- Report actions in `src/features/moderation/server/report-actions.ts`; UI components under feed/Creator views.  
  `[Source: architecture.md#4-Application-Architecture]`

### Testing Requirements
- Unit/integration tests ensure reliability; manual review for policy compliance.  
  `[Source: architecture.md#8-Testing-Strategy]`

### Technical Constraints
- Feature flag for report/appeal availability; ensure privacy (reporter identity access limited).  
  `[Source: architecture.md#Next-Steps]`
- Security: prevent abuse of appeals; rate-limit reports.  
  `[Source: architecture.md#9-Security-Integration]`

## Testing
- Jest tests for report/appeal actions. `[Source: architecture.md#8-Testing-Strategy]`
- Playwright tests for UI flows. `[Source: architecture.md#8-Testing-Strategy]`

## Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2025-01-12 | v0.1 | Draft for user reports & appeals workflow | Bob (scrum-master) |
